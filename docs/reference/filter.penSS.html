<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>filter.penSS. trip</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>

<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>

<!-- mathjax -->
<script src='https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
  </head>

  <body>
    <div class="container">
      <header>
      
<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">trip</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">Home</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/mdsumner/trip">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->
      
      </header>

      <div class="page-header">
  <h1>Non-destructive smoothing filter</h1>
</div>

<div class="row">
  <div class="col-md-9">
    
    <p>Non-destructive filter for track data using penalty smoothing on velocity.</p>
    

    <pre><span class='fu'>filter.penSS</span>(<span class='no'>tr</span>, <span class='no'>lambda</span>, <span class='kw'>first</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>last</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='no'>...</span>)</pre>
    
    <h2>Arguments</h2>
    <dl class="dl-horizontal">
      <dt>tr</dt>
      <dd>A <code>trip</code> object.</dd>
      <dt>lambda</dt>
      <dd>Smoothing parameter, see Details.</dd>
      <dt>first</dt>
      <dd>Fix the first location and prevent it from being updated by the
filter.</dd>
      <dt>last</dt>
      <dd>Fix the last location and prevent it from being updated by the
filter.</dd>
      <dt>&amp;#8230;</dt>
      <dd>Arguments passed on to <code>nlm</code></dd>
    </dl>
    
    <div class="Value">
      <h2>Value</h2>

      <p>A trip object with updated coordinate values based on the filter - all the
data, including original coordinates which are maintained in the trip data
frame.</p>
    </div>

    <div class="Details">
      <h2>Details</h2>

      <p>Destructive filters such as <code><a href='speedfilter.html'>speedfilter</a></code> can be recast using a
penalty smoothing approach in the style of Green and Silverman (1994).</p>
      <p>This filter works by penalizing the fit of the smoothed track to the
observed locations by the sum of squared velocities.  That is, we trade off
goodness of fit against increasing the total sum of squared velocities.</p>
      <p>When lambda=0 the smoothed track reproduces the raw track exactly.
Increasing lambda favours tracks requiring less extreme velocities, at the
expense of reproducing the original locations.</p>
    </div>

    <div class="References">
      <h2>References</h2>

      <p>Green, P. J. and Silverman, B. W. (1994). Nonparametric regression and
generalized linear models: a roughness penalty approach. CRC Press.</p>
    </div>

    <div class="See also">
      <h2>See also</h2>

      <p><code><a href='speedfilter.html'>speedfilter</a></code></p>
    </div>
    
    <h2 id="examples">Examples</h2>
    <pre class="examples"><div class='input'>

<span class='co'>## Not run: ------------------------------------</span>
<span class='co'># ## Example takes a few minutes</span>
<span class='co'># </span>
<span class='co'># ## Fake some data</span>
<span class='co'># </span>
<span class='co'># ## Brownian motion tethered at each end</span>
<span class='co'># brownian.bridge &lt;- function(n, r) {</span>
<span class='co'>#   x &lt;- cumsum(rnorm(n, 0, 1))</span>
<span class='co'>#   x &lt;- x - (x[1] + seq(0, 1, length=n) * (x[n] - x[1]))</span>
<span class='co'>#   r * x</span>
<span class='co'># }</span>
<span class='co'># </span>
<span class='co'># ## Number of days and number of obs</span>
<span class='co'># days &lt;- 50</span>
<span class='co'># n &lt;- 200</span>
<span class='co'># </span>
<span class='co'># ## Make separation between obs gamma distributed</span>
<span class='co'># x &lt;- rgamma(n, 3)</span>
<span class='co'># x &lt;- cumsum(x)</span>
<span class='co'># x &lt;- x/x[n]</span>
<span class='co'># </span>
<span class='co'># ## Track is lissajous + brownian bridge</span>
<span class='co'># b.scale &lt;- 0.6</span>
<span class='co'># r.scale &lt;- sample(c(0.1, 2, 10.2), n, replace=TRUE,</span>
<span class='co'>#                   prob=c(0.8, 0.18, 0.02))</span>
<span class='co'># set.seed(44)</span>
<span class='co'># </span>
<span class='co'># tms &lt;- ISOdate(2001, 1, 1) + trunc(days * 24 * 60 * 60 *x)</span>
<span class='co'># lon &lt;- 120 + 20 * sin(2 * pi * x) +</span>
<span class='co'>#     brownian.bridge(n, b.scale) + rnorm(n, 0, r.scale)</span>
<span class='co'># lat &lt;- -40 + 10 *(sin(3 * 2 * pi * x) + cos(2 * pi * x) - 1) +</span>
<span class='co'>#     brownian.bridge(n, b.scale) + rnorm(n, 0, r.scale)</span>
<span class='co'># </span>
<span class='co'># tr &lt;- new("trip",</span>
<span class='co'>#           SpatialPointsDataFrame(cbind(lon, lat),</span>
<span class='co'>#                                  data.frame(gmt=tms, id="lbb")),</span>
<span class='co'>#                                  TimeOrderedRecords(c("gmt", "id")))</span>
<span class='co'># plot(tr)</span>
<span class='co'># </span>
<span class='co'># ## the filtered version</span>
<span class='co'># trf &lt;- filter.penSS(tr, lambda=1, iterlim=400, print.level=1)</span>
<span class='co'># </span>
<span class='co'># lines(trf)</span>
<span class='co'># </span>
<span class='co'>## ---------------------------------------------</span></div></pre>
  </div>
  <div class="col-md-3">
    <h2>Author</h2>
    
Simon Wotherspoon and Michael Sumner

  </div>
</div>

      <footer>
      <p>Built by <a href="http://hadley.github.io/pkgdown/">pkgdown</a>. Styled with <a href="http://getbootstrap.com">Bootstrap 3</a>.</p>
      </footer>
   </div>

  </body>
</html>
