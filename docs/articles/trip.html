<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>The trip package. trip</title><!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous"><script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous"><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <div class="container">
      <header><div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">trip</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">Home</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/mdsumner/trip">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->
      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>The trip package</h1>
                        <h4 class="author">Michael Sumner</h4>
            
            <h4 class="date">2016-10-18</h4>
          </div>

    
    
<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>Basic use of the trip package.</p>
<div id="data-input-and-validation" class="section level2">
<h2>Data input and validation</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(trip)
d &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x=</span><span class="dv">1</span>:<span class="dv">10</span>,<span class="dt">y=</span><span class="kw">rnorm</span>(<span class="dv">10</span>), <span class="dt">tms=</span><span class="kw">Sys.time</span>() +<span class="st"> </span><span class="dv">1</span>:<span class="dv">10</span>, <span class="dt">id=</span><span class="kw">gl</span>(<span class="dv">2</span>, <span class="dv">5</span>))
<span class="kw">coordinates</span>(d) &lt;-<span class="st"> </span><span class="er">~</span>x+y
## a projection should always be set, is it WGS84 or NAD83 . . .
<span class="kw">proj4string</span>(d) &lt;-<span class="st"> </span><span class="kw">CRS</span>(<span class="st">"+proj=laea +ellps=sphere"</span>)
tr &lt;-<span class="st"> </span><span class="kw">trip</span>(d, <span class="kw">c</span>(<span class="st">"tms"</span>, <span class="st">"id"</span>))
<span class="kw">summary</span>(tr)</code></pre></div>
<pre><code>## 
## Object of class trip
##   tripID ("id") No.Records   startTime ("tms")     endTime ("tms")
## 1             1          5 2016-10-18 05:18:49 2016-10-18 05:18:53
## 2             2          5 2016-10-18 05:18:54 2016-10-18 05:18:58
##   tripDuration tripDistance meanSpeed maxSpeed meanRMSspeed maxRMSspeed
## 1       4 secs     8.190590  7371.531  9933.45     1577.602    6310.407
## 2       4 secs     7.404171  6663.754 11054.78     1867.358    7469.430
## 
## Total trip duration: 8 seconds (0 hours, 8 seconds)
## 
## Derived from Spatial data:
## 
## Object of class SpatialPointsDataFrame
## Coordinates:
##         min       max
## x  1.000000 10.000000
## y -1.488202  1.505859
## Is projected: TRUE 
## proj4string : [+proj=laea +ellps=sphere]
## Number of points: 10
## Data attributes:
##       tms                      id   
##  Min.   :2016-10-18 16:18:49   1:5  
##  1st Qu.:2016-10-18 16:18:51   2:5  
##  Median :2016-10-18 16:18:53        
##  Mean   :2016-10-18 16:18:53        
##  3rd Qu.:2016-10-18 16:18:55        
##  Max.   :2016-10-18 16:18:58</code></pre>
</div>
</div>
<div id="simple-plotting" class="section level1">
<h1>Simple plotting</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(tr)
<span class="kw">lines</span>(tr)</code></pre></div>
<p><img src="trip_files/figure-html/unnamed-chunk-6-1.png" width="672"></p>
<p>Plot of a very simple trip object.</p>
</div>
<div id="gridding-for-time-spent" class="section level1">
<h1>Gridding for time spent</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tg &lt;-<span class="st"> </span><span class="kw">rasterize</span>(tr)
<span class="kw">plot</span>(tg, <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">"transparent"</span>, <span class="kw">heat.colors</span>(<span class="dv">25</span>)))</code></pre></div>
<p><img src="trip_files/figure-html/unnamed-chunk-7-1.png" width="672"></p>
<p>Plot of a rasterized version of the trip, by default this is a map of <strong>time-spent</strong>.</p>
</div>
<div id="walrus-tracks" class="section level1">
<h1>Walrus tracks</h1>
<p>Plot the walrus tracks on a map.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(<span class="st">"walrus818"</span>)

<span class="kw">plot</span>(walrus818, <span class="dt">pch =</span> <span class="st">"."</span>)
<span class="kw">lines</span>(walrus818)</code></pre></div>
<p><img src="trip_files/figure-html/unnamed-chunk-8-1.png" width="672"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(maptools)
<span class="kw">library</span>(rgdal)
<span class="kw">data</span>(wrld_simpl)
world &lt;-<span class="st"> </span><span class="kw">spTransform</span>(<span class="kw">subset</span>(wrld_simpl, <span class="kw">coordinates</span>(wrld_simpl)[,<span class="dv">2</span>] &gt;<span class="st"> </span><span class="dv">0</span>), <span class="kw">proj4string</span>(walrus818))
p &lt;-<span class="st"> </span><span class="kw">par</span>(<span class="dt">xpd =</span> <span class="ot">NA</span>, <span class="dt">mar =</span> <span class="kw">rep</span>(<span class="fl">0.5</span>, <span class="dv">4</span>))
<span class="kw">plot</span>(walrus818, <span class="dt">pch =</span> <span class="st">"."</span>)
<span class="kw">plot</span>(world, <span class="dt">add =</span> <span class="ot">TRUE</span>, <span class="dt">col =</span> <span class="st">"grey"</span>)
<span class="kw">lines</span>(walrus818)
<span class="kw">llgridlines</span>(walrus818); <span class="kw">par</span>(p)</code></pre></div>
<p><img src="trip_files/figure-html/unnamed-chunk-9-1.png" width="672"></p>
</div>
<div id="combine-multipel-sets-of-track-data" class="section level1">
<h1>Combine multipel sets of track data</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(diveMove)
fname &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="kw">file.path</span>(<span class="st">"data"</span>, <span class="st">"sealLocs.csv"</span>),
                       <span class="dt">package=</span><span class="st">"diveMove"</span>)
    dat &lt;-<span class="st"> </span><span class="kw">read.table</span>(fname, <span class="dt">sep=</span><span class="st">";"</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>, <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)
    dat$class &lt;-<span class="st"> </span><span class="kw">ordered</span>(dat$class, <span class="kw">c</span>(<span class="st">"Z"</span>, <span class="st">"B"</span>, <span class="st">"A"</span>, <span class="st">"0"</span>, <span class="st">"1"</span>, <span class="st">"2"</span>, <span class="st">"3"</span>))
    dat$time &lt;-<span class="st"> </span><span class="kw">as.POSIXct</span>(<span class="kw">strptime</span>(dat$time, <span class="st">"%Y-%m-%d %H:%M:%S"</span>), <span class="dt">tz =</span> <span class="st">"GMT"</span>)

locs &lt;-<span class="st"> </span><span class="kw">subset</span>(dat, !<span class="kw">is.na</span>(dat$lon))
<span class="kw">trip</span>(locs) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">"lon"</span>, <span class="st">"lat"</span>, <span class="st">"time"</span>, <span class="st">"id"</span>)
<span class="kw">proj4string</span>(locs) &lt;-<span class="st"> " +proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs +towgs84=0,0,0"</span>

## merge with data from argosfilter
<span class="kw">library</span>(argosfilter)
<span class="kw">data</span>(seal)
seal$id &lt;-<span class="st"> "ringy2"</span>
seal[[<span class="st">"time"</span>]] &lt;-<span class="st"> </span>seal$dtime
seal$dtime &lt;-<span class="st"> </span><span class="ot">NULL</span>
## reconstruct the Argos labels
seal[[<span class="st">"class"</span>]] &lt;-<span class="st"> </span><span class="kw">ordered</span>(<span class="kw">levels</span>(dat$class)[<span class="kw">factor</span>(seal$lc, <span class="kw">sort</span>(<span class="kw">unique</span>(seal$lc)))], <span class="kw">levels</span>(dat$class))
seal$lc &lt;-<span class="st"> </span><span class="ot">NULL</span>


## what are we supposed to do with duplicated times?
##  which(!diff(seal$time) &gt; 0)
##[1]   17  116  122 1008 1158 1231 1293 1300
##plot(seal[which(!diff(seal$time) &gt; 0),c("lon", "lat") ])
##points(seal[1 + which(!diff(seal$time) &gt; 0),c("lon", "lat") ], col = "red")

seal &lt;-<span class="st"> </span>seal[!<span class="kw">duplicated</span>(seal$time), ]

## drop missing data and combine
dat &lt;-<span class="st"> </span><span class="kw">rbind</span>(dat[!<span class="kw">is.na</span>(dat$lon), ], seal[,<span class="kw">names</span>(dat)])
##coordinates(dat) &lt;- c("lon", "lat")
##proj4string(dat) &lt;- CRS("+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs +towgs84=0,0,0")

tr &lt;-<span class="st"> </span>dat
<span class="kw">trip</span>(dat) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">"lon"</span>, <span class="st">"lat"</span>, <span class="st">"time"</span>, <span class="st">"id"</span>)
<span class="kw">proj4string</span>(dat) &lt;-<span class="st"> </span><span class="kw">CRS</span>(<span class="st">"+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs +towgs84=0,0,0"</span>)

<span class="kw">library</span>(raster)
d2 &lt;-<span class="st"> </span><span class="kw">spTransform</span>(dat, <span class="kw">projection</span>(walrus818))
<span class="kw">plot</span>(<span class="kw">union</span>(<span class="kw">extent</span>(d2), <span class="kw">extent</span>(walrus818)))
<span class="kw">lines</span>(d2)
<span class="kw">lines</span>(walrus818)
<span class="kw">plot</span>(<span class="kw">spTransform</span>(<span class="kw">subset</span>(wrld_simpl, <span class="kw">coordinates</span>(wrld_simpl)[,<span class="dv">2</span>] &gt;<span class="st"> </span><span class="dv">0</span>), <span class="kw">projection</span>(walrus818)), <span class="dt">add =</span> T, <span class="dt">col =</span> <span class="st">"grey"</span>)</code></pre></div>
<p><img src="trip_files/figure-html/unnamed-chunk-10-1.png" width="672"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs">
        <div id="tocnav">
      <h2>Contents</h2>
      <ul class="nav nav-pills nav-stacked"><li><a href="#introduction">Introduction</a><ul class="nav nav-pills nav-stacked"><li><a href="#data-input-and-validation">Data input and validation</a></li>
      </ul></li>
      <li><a href="#simple-plotting">Simple plotting</a></li>
      <li><a href="#gridding-for-time-spent">Gridding for time spent</a></li>
      <li><a href="#walrus-tracks">Walrus tracks</a></li>
      <li><a href="#combine-multipel-sets-of-track-data">Combine multipel sets of track data</a></li>
      </ul></div>
      </div>

</div>


      <footer><p>Built by <a href="http://hadley.github.io/pkgdown/">pkgdown</a>. Styled with <a href="http://getbootstrap.com">Bootstrap 3</a>.</p>
      </footer></div>

  </body></html>
