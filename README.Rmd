---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, echo = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "README-"
)
```


[![Travis-CI Build Status](http://badges.herokuapp.com/travis/Trackage/trip?branch=master&env=BUILD_NAME=trusty_release&label=linux)](https://travis-ci.org/Trackage/trip)
[![OSX Build Status](http://badges.herokuapp.com/travis/Trackage/trip?branch=master&env=BUILD_NAME=osx_release&label=osx)](https://travis-ci.org/Trackage/trip)
[![AppVeyor build status](https://ci.appveyor.com/api/projects/status/github/Trackage/trip?branch=master&svg=true)](https://ci.appveyor.com/project/Trackage/trip)[![Coverage_Status](https://img.shields.io/codecov/c/github/Trackage/trip/master.svg)](https://codecov.io/github/Trackage/trip?branch=master)
[![CRAN_Status_Badge](http://www.r-pkg.org/badges/version/trip)](https://cran.r-project.org/package=trip)
[![CRAN_Download_Badge](http://cranlogs.r-pkg.org/badges/trip)](https://cran.r-project.org/package=trip)


# Tools for animal track data

The trip package provides functions for accessing and manipulating
spatial data for animal tracking.  Filter for speed and create time
spent plots from animal track data.

Let me know what you think via [Issues](https://github.com/Trackage/trip/issues). 


## Installing

The package is easily installed from CRAN in R. 

```R
install.packages("trip")
```

## Install dev version

To install the development package from Github: 

```R
remotes::install_github("Trackage/trip")
```


# Current concerns


Currently working on tidying up old daggy ends, see [next release milestones](https://github.com/Trackage/trip/milestone/2). 

I want it to be very easy to create trip objects from other forms, either by reading known formats (Argos), coercion from other packages (sp, sf, adehabitatLT, move, etc.), or from raw data with a dplyr/gg aesthetic e.g. this kind of construct from a data frame: 

```{r raw-dataframe}
d <- read.csv(system.file("extdata/MI_albatross_sub10.csv", package = "trip"), stringsAsFactors = FALSE)
d$gmt <- as.POSIXct(d$gmt, tz = "UTC")
library(dplyr)
library(trip)
tr <- d %>% arrange(tag_ID, gmt) %>% group_by(tag_ID) %>%  select(lon, lat, gmt, everything()) %>% trip()

## OR this for the same outcome
tr <- trip(dplyr::select(d, lon, lat, gmt, tag_ID, everything()))
```

Longitude latitude is assumed if the values have sane ranges. 


There is some ongoing integration with the `sf` package, mostly to provide outputs in its
formats.  

We can nominate the date-time and trip ID column of an sf POINT data frame. 

```{r sf-proto, eval=FALSE}
trip(sf, c("time", "id"))
```

It's unclear what do do with MULTIPOINT, unless `XYZ[,3]` is the times and `$time` is the *offset*?  Or we just assume constant time interval from the `time`. But otherwise, MULTIPOINT or LINESTRING is a kind of neat grouping. 


We can already convert to POINT: 

```{r coerce-sf-1}
library(trip)
sf::st_as_sf(walrus818)

```
or atomic LINESTRING with time on the MEASURE:

```{r coerce-sf-2}
as(walrus818, "sf")
```

But, trip itself would be better implemented on top of the ideas in [the silicate package](https://github.com/hypertidy/silicate/), rather than the twilight zone between MULTIPOINTs and LINESTRINGs as it is now. 

# Development

* **partly done** trip should work with sf or sp, there's really no need to distinguish these
* ability to treat all line segments as continuous, as `cut.trip` can for rasterizing, possibly needs a second-level ID grouping
* separate out reading functionality to [rgos](https://github.com/mdsumner/rgos)
* separate out algorithm functions into a generic package that other tracking packages could use (distance, speed, angle filtering, rasterizing, time spent, interpolation etc.)


Let me know what you think via [Issues](https://github.com/Trackage/trip/issues). 


## TODO

- **Probability image**.  The SGAT (and tripEstimation) packages have
functions for dealing with spatial track summaries that are
atomized to the level of each time step. There are methods for combining summaries from
multiple tracks and for casting arbitrary durations (by sum) to standard image structures. This would be a good
feature to replace the existing tripGrid function by storing the 
individual grid summaries for each implicit line segment.

- **Coercion to/from other classes** See [spbabel](https://github.com/mdsumner/spbabel). 

- **Validation** Must include a detailed report object of where the problems are, and how to filter/fix/flush them. 
 
 
 
 
Please note that this project is released with a [Contributor Code of Conduct](CONDUCT.md). By participating in this project you agree to abide by its terms.
