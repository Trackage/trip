<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>The trip package • trip</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="The trip package">
<meta property="og:description" content="trip">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">trip</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.7.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/trip.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/trip-rationale.html">trip-rationale</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/Trackage/trip/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>The trip package</h1>
                        <h4 class="author">Michael Sumner</h4>
            
            <h4 class="date">2020-06-15</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/Trackage/trip/blob/master/vignettes/trip.Rmd"><code>vignettes/trip.Rmd</code></a></small>
      <div class="hidden name"><code>trip.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>Basic use of the trip package.</p>
<div id="data-input-and-validation" class="section level2">
<h2 class="hasAnchor">
<a href="#data-input-and-validation" class="anchor"></a>Data input and validation</h2>
<p>Tracking data is in essence a grouped series of one-dimensional data<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> records.</p>
<p>It is <em>grouped</em> because we may track more than one object, each with its on independent time sequence.</p>
<p>It is <em>one-dimensional</em> because the topology of the data is a linear stream of values. It makes sense that time is constantly increasing, and it is the primary dimension of the process. (Location is often something that we must estimate, but time is usually directly measured and robust).</p>
<p>Commonly we have records in a data frame, and the primary workflow is to provide the <code><a href="../reference/trip-methods.html">trip()</a></code> function with information about the spatial locations, the temporal data, and the grouping.</p>
<p>The data may contain any other columns, and in general they can be called anything and be in any order, but the simplest way to create a <code>trip</code> is to put the first four columns as X, Y, date-time, grouping.</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">trip</span>)
<span class="no">d</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="kw">x</span><span class="kw">=</span><span class="fl">1</span>:<span class="fl">10</span>,<span class="kw">y</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="fl">10</span>), <span class="kw">tms</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.time</a></span>() + <span class="fl">1</span>:<span class="fl">10</span>, <span class="kw">id</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/gl.html">gl</a></span>(<span class="fl">2</span>, <span class="fl">5</span>))
<span class="no">tr</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/trip-methods.html">trip</a></span>(<span class="no">d</span>)</pre></body></html></div>
<pre><code>## Warning in assume_if_longlat(out): input looks like longitude/latitude data,
## assuming +proj=longlat +datum=WGS84</code></pre>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">tr</span>)</pre></body></html></div>
<pre><code>## 
## Object of class trip
##   tripID ("id") No.Records   startTime ("tms")     endTime ("tms") tripDuration
## 1             1          5 2020-06-15 07:31:13 2020-06-15 07:31:17       4 secs
## 2             2          5 2020-06-15 07:31:18 2020-06-15 07:31:22       4 secs
##   tripDistance meanSpeed maxSpeed
## 1     783.7201  705348.1 829807.9
## 2     563.0928  506783.6 590145.4
## 
## Total trip duration: 8 seconds (0 hours, 8 seconds)
## 
## Derived from Spatial data:
## 
## Object of class SpatialPointsDataFrame
## Coordinates:
##         min       max
## x  1.000000 10.000000
## y -1.514667  1.421042
## Is projected: FALSE 
## proj4string : [+proj=longlat +datum=WGS84]
## Number of points: 10
## Data attributes:
##       tms                      id   
##  Min.   :2020-06-15 07:31:13   1:5  
##  1st Qu.:2020-06-15 07:31:15   2:5  
##  Median :2020-06-15 07:31:17        
##  Mean   :2020-06-15 07:31:17        
##  3rd Qu.:2020-06-15 07:31:19        
##  Max.   :2020-06-15 07:31:22</code></pre>
<p>(There may be only one group, but we have to be explicit, with a column that identifies at least one group).</p>
<p>When a print or summary is made the data are presented in terms of their grouping, with some handy summary values. When converting to <code>sf</code> or <code>sp</code> form as lines these summary values are recorded with each “multi”-line.</p>
</div>
</div>
<div id="simple-plotting" class="section level1">
<h1 class="hasAnchor">
<a href="#simple-plotting" class="anchor"></a>Simple plotting</h1>
<p>To plot a trip we use base graphics in the usual ways.</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">tr</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span>(<span class="no">tr</span>)</pre></body></html></div>
<p><img src="trip_files/figure-html/unnamed-chunk-2-1.png" width="700"></p>
<p>The trip object acts as a <code>sp</code> data frame of points, but with the underlying grouping as lines when that is relevant.</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">tr</span>,<span class="kw">pch</span> <span class="kw">=</span> <span class="st">"."</span>, <span class="kw">col</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">rainbow</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="no">tr</span>)))
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span>(<span class="no">tr</span>, <span class="kw">col</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"dodgerblue"</span>, <span class="st">"firebrick"</span>))</pre></body></html></div>
<p><img src="trip_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
</div>
<div id="gridding-for-time-spent" class="section level1">
<h1 class="hasAnchor">
<a href="#gridding-for-time-spent" class="anchor"></a>Gridding for time spent</h1>
<p>There is a key functionality to determine the <em>time spent in area</em> on a grid, by leveraging the <code><a href="../reference/rasterize.html">rasterize()</a></code> generic function in the raster package. Any raster object may be used, so the specification of pixel area, extent and map projection is up to the user. (The trip line segments must all fall within the raster).</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="no">tg</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/rasterize.html">rasterize</a></span>(<span class="no">tr</span>)
<span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">tg</span>, <span class="kw">col</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"transparent"</span>, <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">heat.colors</a></span>(<span class="fl">25</span>)))</pre></body></html></div>
<p><img src="trip_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
<p>As with <code><a href="https://rdrr.io/pkg/raster/man/rasterize.html">raster::rasterize()</a></code> the <code>field</code> used may be chosen, by default the time difference between each point in a trip is used, and the final grid contains the sum of these durations.</p>
<p>There is an older version of this in the <code>tripGrid.interp</code> function that uses approximate methods by allowing interpolation to an ‘equal time’ step.</p>
</div>
<div id="reading-from-argos-files" class="section level1">
<h1 class="hasAnchor">
<a href="#reading-from-argos-files" class="anchor"></a>Reading from Argos files</h1>
<p>Service Argos has provide various message formats, and the <code><a href="../reference/readArgos.html">readArgos()</a></code> function understands some variants of the ‘PRV’ form. Multiple files can be provided, and all messages will be normalized and turned into a trip object with no need for the user to group or clean them in any way.</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="no">argosfile</span> <span class="kw">&lt;-</span>
 <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">"extdata/argos/98feb.dat"</span>, <span class="kw">package</span> <span class="kw">=</span> <span class="st">"trip"</span>, <span class="kw">mustWork</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="no">argos</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/readArgos.html">readArgos</a></span>(<span class="no">argosfile</span>)</pre></body></html></div>
<pre><code>## 
## Longitudes contain values greater than 180, 
## 
## 
## 
## 
##  Data fully validated: returning object of class  trip</code></pre>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">argos</span>)</pre></body></html></div>
<pre><code>## 
## Object of class trip
##    tripID ("ptt") No.Records   startTime ("gmt")     endTime ("gmt")
## 1            2163        134 1998-02-01 03:32:32 1998-02-24 07:33:35
## 2            6072        150 1998-02-01 03:30:03 1998-02-28 23:16:54
## 3            6073        149 1998-02-03 20:47:38 1998-02-28 23:11:56
## 4            6074        194 1998-02-01 01:51:52 1998-02-28 09:27:23
## 5            6075        160 1998-02-01 17:25:23 1998-02-28 23:17:54
## 6            6076        157 1998-02-01 03:26:28 1998-02-24 07:34:53
## 7            9301        203 1998-02-01 03:33:42 1998-02-28 06:07:30
## 8            9302         87 1998-02-01 05:09:25 1998-02-26 16:10:40
## 9            9303         12 1998-02-01 01:07:29 1998-02-06 09:12:07
## 10           9373        207 1998-02-01 01:51:09 1998-02-24 07:36:01
## 11           9374        191 1998-02-02 15:34:44 1998-02-28 21:36:10
## 12           9375        109 1998-02-01 01:50:39 1998-02-27 03:48:20
## 13           9376        136 1998-02-01 17:26:47 1998-02-22 16:59:45
## 14           9377        115 1998-02-02 07:17:31 1998-02-22 23:48:03
##     tripDuration tripDistance  meanSpeed     maxSpeed
## 1   23.1674 days    1865.7487   6.441413    38.003719
## 2   27.8242 days    1894.6721   6.128032   145.251489
## 3  25.10021 days    1825.6069   6.004080   178.192971
## 4  27.31633 days    2241.5163  12.318890   577.145877
## 5   27.2448 days    1730.3140 114.630616 17393.145193
## 6  23.17251 days    2277.5287   8.759922   158.324144
## 7  27.10681 days    3107.6614  42.621290  6649.062042
## 8   25.4592 days    1034.6549   3.079610    24.671973
## 9  5.336551 days     160.2035   2.563500     7.675708
## 10 23.23949 days    2370.2940 165.640436 32335.751235
## 11   26.251 days    1863.8627  89.308060 15503.634403
## 12 26.08172 days    2531.4993  14.742137   502.168226
## 13 20.98123 days    1521.9433   5.339746    47.063667
## 14 20.68787 days    1164.6709   4.730864    49.179020
## 
## Total trip duration: 28422949 seconds (7895 hours, 949 seconds)
## 
## Derived from Spatial data:
## 
## Object of class SpatialPointsDataFrame
## Coordinates:
##               min     max
## longitude 318.281 328.453
## latitude  -54.689 -51.449
## Is projected: FALSE 
## proj4string : [+proj=longlat +datum=WGS84]
## Number of points: 2004
## Data attributes:
##     prognum         ptt           nlines          nsensor      satname  class  
##  Min.   :920   Min.   :2163   Min.   : 2.000   Min.   : 1.00   D:1001   Z:  0  
##  1st Qu.:920   1st Qu.:6074   1st Qu.: 3.000   1st Qu.:32.00   J:1003   B:403  
##  Median :920   Median :9301   Median : 4.000   Median :32.00            A:376  
##  Mean   :920   Mean   :7547   Mean   : 4.428   Mean   :29.93            0:704  
##  3rd Qu.:920   3rd Qu.:9374   3rd Qu.: 5.000   3rd Qu.:32.00            1:420  
##  Max.   :920   Max.   :9377   Max.   :58.000   Max.   :32.00            2: 83  
##                                                                         3: 18  
##      date               time              altitude   transfreq        
##  Length:2004        Length:2004        Min.   :0   Min.   :401648599  
##  Class :character   Class :character   1st Qu.:0   1st Qu.:401649265  
##  Mode  :character   Mode  :character   Median :0   Median :401649474  
##                                        Mean   :0   Mean   :401649505  
##                                        3rd Qu.:0   3rd Qu.:401649747  
##                                        Max.   :0   Max.   :401650517  
##                                                                       
##       gmt                     
##  Min.   :1998-02-01 01:07:29  
##  1st Qu.:1998-02-07 16:19:52  
##  Median :1998-02-13 04:40:36  
##  Mean   :1998-02-13 20:18:48  
##  3rd Qu.:1998-02-20 07:48:41  
##  Max.   :1998-02-28 23:17:54  
## </code></pre>
<p>Note that the form of the coordinates is native to the PRV file, and in this case contains longitude values that are greater than 180. Some forms of these files provide wrapped forms, but in general the data are read as-is.</p>
<p>(We need “world2” because we are at 40W, but +360).</p>
<div class="sourceCode" id="cb12"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">argos</span>, <span class="kw">pch</span> <span class="kw">=</span> <span class="st">"."</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span>(<span class="no">argos</span>)
<span class="kw pkg">maps</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/maps/man/map.html">map</a></span>(<span class="st">"world2"</span>, <span class="kw">add</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/axis.html">axis</a></span>(<span class="fl">1</span>)
<span class="kw pkg">sp</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/sp/man/degaxis.html">degAxis</a></span>(<span class="fl">2</span>)</pre></body></html></div>
<p><img src="trip_files/figure-html/plot-argos-anti-meridian-1.png" width="700"></p>
</div>
<div id="destructive-filtering" class="section level1">
<h1 class="hasAnchor">
<a href="#destructive-filtering" class="anchor"></a>Destructive filtering</h1>
<p>There are some classic data filters based on speed and angle, and we may chain these together for some cheap improvements to track data, or use them separately.</p>
<div class="sourceCode" id="cb13"><html><body><pre class="r"><span class="no">argos</span>$<span class="no">spd</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/speedfilter.html">speedfilter</a></span>(<span class="no">argos</span>, <span class="kw">max.speed</span> <span class="kw">=</span> <span class="fl">4</span>)  <span class="co">## km/h</span>
<span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="no">argos</span>$<span class="no">spd</span>)  <span class="co">## more than 5% are too fast</span></pre></body></html></div>
<pre><code>## [1] 0.748503</code></pre>
<div class="sourceCode" id="cb15"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">argos</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span>(<span class="no">argos</span>[<span class="no">argos</span>$<span class="no">spd</span> <span class="kw">&amp;</span> <span class="no">argos</span>$<span class="no">class</span> <span class="kw">&gt;</span> <span class="st">"A"</span>, ])</pre></body></html></div>
<p><img src="trip_files/figure-html/destructive-filters-1.png" width="700"></p>
<div class="sourceCode" id="cb16"><html><body><pre class="r"><span class="no">argos</span>$<span class="no">sda</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/sda.html">sda</a></span>(<span class="no">argos</span>, <span class="kw">smax</span> <span class="kw">=</span> <span class="fl">12</span>)  <span class="co">## defaults based on argosfilter, Freitas et al. (2008) </span>
<span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="no">argos</span>$<span class="no">sda</span>)</pre></body></html></div>
<pre><code>## [1] 0.8687625</code></pre>
<div class="sourceCode" id="cb18"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">argos</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span>(<span class="no">argos</span>[<span class="no">argos</span>$<span class="no">sda</span>, ])</pre></body></html></div>
<p><img src="trip_files/figure-html/destructive-filters-2.png" width="700"></p>
</div>
<div id="map-projections" class="section level1">
<h1 class="hasAnchor">
<a href="#map-projections" class="anchor"></a>Map projections</h1>
<p>Data may be stored in longitude latitude or using a map projection, an in-built data set uses the Azimuthal Equidistant family near the anti-meridian in the Bering Strait.</p>
<div class="sourceCode" id="cb19"><html><body><pre class="r"><span class="kw pkg">raster</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/projection.html">projection</a></span>(<span class="no">walrus818</span>)</pre></body></html></div>
<pre><code>## Warning in proj4string(x): CRS object has comment, which is lost in output</code></pre>
<pre><code>## [1] "+proj=aeqd +lat_0=70 +lon_0=-170 +x_0=0 +y_0=0 +datum=WGS84 +units=m +no_defs"</code></pre>
<div class="sourceCode" id="cb22"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">"walrus818"</span>)

<span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">walrus818</span>, <span class="kw">pch</span> <span class="kw">=</span> <span class="st">"."</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span>(<span class="no">walrus818</span>)

<span class="fu"><a href="https://rdrr.io/r/graphics/axis.html">axis</a></span>(<span class="fl">1</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/axis.html">axis</a></span>(<span class="fl">2</span>)</pre></body></html></div>
<p><img src="trip_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<div class="sourceCode" id="cb23"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">"world_north"</span>, <span class="kw">package</span><span class="kw">=</span> <span class="st">"trip"</span>)
<span class="no">p</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">mar</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">0.5</span>, <span class="fl">4</span>))
<span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="kw pkg">raster</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/extent.html">extent</a></span>(<span class="no">walrus818</span>) + <span class="fl">600000</span>)
<span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">walrus818</span>, <span class="kw">pch</span> <span class="kw">=</span> <span class="st">"."</span>, <span class="kw">add</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">world_north</span>, <span class="kw">add</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">col</span> <span class="kw">=</span> <span class="st">"grey"</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span>(<span class="no">walrus818</span>)</pre></body></html></div>
<p><img src="trip_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<div class="sourceCode" id="cb24"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="no">p</span>)</pre></body></html></div>
</div>
<div id="data-conversions" class="section level1">
<h1 class="hasAnchor">
<a href="#data-conversions" class="anchor"></a>Data conversions</h1>
<p>There are various conversions from other tracking data types, the <code><a href="../reference/trip-methods.html">trip()</a></code> function aims to be a helpful function like <code><a href="https://rdrr.io/pkg/raster/man/raster.html">raster::raster()</a></code>, simply understanding many formats.</p>
<p>It’s possible to export trips to Google Earth, for interacting with the time slider in continuous time. Use <code><a href="../reference/write_track_kml.html">write_track_kml()</a></code> to produce a ‘KML/KMZ’ file.</p>
<p>When converting to spatial forms we may choose multi-lines, points, or segments.</p>
<p>Conversion to points, in sp or spatstat.</p>
<div class="sourceCode" id="cb25"><html><body><pre class="r"><span class="co">## as points</span>
<span class="fu">as</span>(<span class="no">walrus818</span>, <span class="st">"SpatialPointsDataFrame"</span>)</pre></body></html></div>
<pre><code>## class       : SpatialPointsDataFrame 
## features    : 10558 
## extent      : -117277, 307789, -412557, 84896  (xmin, xmax, ymin, ymax)</code></pre>
<pre><code>## Warning in proj4string(x): CRS object has comment, which is lost in output</code></pre>
<pre><code>## crs         : +proj=aeqd +lat_0=70 +lon_0=-170 +x_0=0 +y_0=0 +datum=WGS84 +units=m +no_defs 
## variables   : 4
## names       : Deployment,     DataDT, Wet, Forage 
## min values  :        353, 1252987200,   0,      0 
## max values  :        444, 1287601200,   1,      1</code></pre>
<div class="sourceCode" id="cb29"><html><body><pre class="r"><span class="fu">as</span>(<span class="no">walrus818</span>, <span class="st">"ppp"</span>)</pre></body></html></div>
<pre><code>## Marked planar point pattern: 10558 points
## Mark variables: Deployment, DataDT, Wet, Forage 
## window: rectangle = [-117277, 307789] x [-412557, 84896] units</code></pre>
<p>Conversion to lines, in sp, sf, or adehabitatLT.</p>
<div class="sourceCode" id="cb31"><html><body><pre class="r"><span class="co">## as lines</span>
<span class="fu">as</span>(<span class="no">walrus818</span>, <span class="st">"SpatialLinesDataFrame"</span>)</pre></body></html></div>
<pre><code>## class       : SpatialLinesDataFrame 
## features    : 14 
## extent      : -117277, 307789, -412557, 84896  (xmin, xmax, ymin, ymax)
## crs         : +proj=aeqd +lat_0=70 +lon_0=-170 +x_0=0 +y_0=0 +datum=WGS84 +units=m +no_defs 
## variables   : 4
## names       : tripID,  tripStart,    tripEnd, tripDur 
## min values  :    353, 1252987200, 1254337200, 1195200 
## max values  :    444, 1283878800, 1287601200, 5695200</code></pre>
<div class="sourceCode" id="cb33"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span>(<span class="fu">as</span>(<span class="no">walrus818</span>, <span class="st">"sf"</span>))</pre></body></html></div>
<pre><code>## Warning in sp::proj4string(from): CRS object has comment, which is lost in
## output</code></pre>
<pre><code>## [1] "sf"         "data.frame"</code></pre>
<div class="sourceCode" id="cb36"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span>(<span class="fu">as</span>(<span class="no">walrus818</span>, <span class="st">"sf"</span>)$<span class="no">geom</span>)</pre></body></html></div>
<pre><code>## Warning in sp::proj4string(from): CRS object has comment, which is lost in
## output</code></pre>
<pre><code>## [1] "sfc_LINESTRING" "sfc"</code></pre>
<div class="sourceCode" id="cb39"><html><body><pre class="r"><span class="fu">as</span>(<span class="no">walrus818</span>, <span class="st">"ltraj"</span>)</pre></body></html></div>
<pre><code>## Loading required namespace: adehabitatLT</code></pre>
<pre><code>## Registered S3 methods overwritten by 'adehabitatMA':
##   method                       from
##   print.SpatialPixelsDataFrame sp  
##   print.SpatialPixels          sp</code></pre>
<pre><code>## 
## *********** List of class ltraj ***********
## 
## Type of the traject: Type II (time recorded)
## * Time zone: GMT *
## Irregular traject. Variable time lag between two locs
## 
## Characteristics of the bursts:
##     id burst nb.reloc NAs          date.begin            date.end
## 1  353   353      160   0 2009-09-15 04:00:00 2009-09-30 19:00:00
## 2  354   354      813   0 2009-09-16 04:00:00 2009-10-20 00:00:00
## 3  355   355     1151   0 2009-09-16 04:00:00 2009-11-04 19:00:00
## 4  356   356     1534   0 2009-09-16 23:00:00 2009-11-21 21:00:00
## 5  357   357     1274   0 2009-09-16 23:00:00 2009-11-09 22:00:00
## 6  358   358      596   0 2009-09-16 23:00:00 2009-10-18 19:00:00
## 7  359   359     1053   0 2009-09-16 23:00:00 2009-10-30 19:00:00
## 8  361   361      556   0 2009-09-17 01:00:00 2009-11-06 04:00:00
## 9  362   362      301   0 2009-09-17 01:00:00 2009-10-03 17:00:00
## 10 366   366      405   0 2009-09-19 15:00:00 2009-10-12 20:00:00
## 11 367   367     1172   0 2009-09-17 01:00:00 2009-11-10 16:00:00
## 12 368   368      151   0 2009-09-19 02:00:00 2009-10-02 22:00:00
## 13 443   443     1035   0 2010-09-07 17:00:00 2010-10-20 19:00:00
## 14 444   444      357   0 2010-09-07 17:00:00 2010-09-28 05:00:00
## 
## 
##  infolocs provided. The following variables are available:
## [1] "pkey"</code></pre>
<p>Conversions to segments, in sp, spatstat.</p>
<div class="sourceCode" id="cb43"><html><body><pre class="r"><span class="co">## as segments</span>
<span class="fu"><a href="../reference/as.Other.html">explode</a></span>(<span class="no">walrus818</span>)</pre></body></html></div>
<pre><code>## class       : SpatialLinesDataFrame 
## features    : 10544 
## extent      : -117277, 307789, -412557, 84896  (xmin, xmax, ymin, ymax)
## crs         : +proj=aeqd +lat_0=70 +lon_0=-170 +x_0=0 +y_0=0 +datum=WGS84 +units=m +no_defs 
## variables   : 4
## names       :  starttime,    endtime, timedur,  id 
## min values  : 1252987200, 1252990800,    3600, 353 
## max values  : 1287597600, 1287601200, 2152800, 444</code></pre>
<div class="sourceCode" id="cb45"><html><body><pre class="r"><span class="fu">as</span>(<span class="no">walrus818</span>, <span class="st">"psp"</span>)</pre></body></html></div>
<pre><code>## marked planar line segment pattern: 10544 line segments
## Mark variables:  origMarks, pattern
## window: rectangle = [-117277, 307789] x [-412557, 84896] units</code></pre>
</div>
<div id="why-not-sf" class="section level1">
<h1 class="hasAnchor">
<a href="#why-not-sf" class="anchor"></a>Why not sf?</h1>
<p>The trip package cops a bit of dismissive criticism because it’s based on sp which is somehow seen as hopelessly legacy. Trip uses sp in powerful ways, but the greatest power is</p>
<ul>
<li>no dependence on unnecessary libs (no GDAL, no GEOS)</li>
<li>efficient storage of points</li>
</ul>
<p>There’s some excitement about the new sf package, and some moves to write yet another trajectory formalism based on sf. I would never use it, sf is a non starter for track data. If these things change I would reconsider, but I don’t see that happening as sf is extremely brittle now, also these suggestions were made early and ignored.</p>
<ul>
<li>simple features (the standard) is not capable of storing tracking data</li>
<li>sf splits up sets of points <em>in a list</em>
</li>
<li>sf brings GDAL and GEOS along with it with no opt-out.</li>
</ul>
<p>Trip has a lot of problems, but these basic things are just no-go. It’s been said trip is only point-based, but the time-spent gridding, the speed filtering, and the conversion to line segments is all clearly line-based. I’m still looking for sensible collaboration for a better system in R, but to me it’s as simple as a grouped data frame with dplyr/ggplot2 semantics. Anything more requires a multi-table system and shoe-horning into the sf straitjacket is not going to work.</p>
<p>See vignette ‘trip-rationale’ for a longer version.</p>
</div>
<div class="footnotes">
<hr>
<ol>
<li id="fn1"><p><em>One-dimensional, are you crazy?</em> Yes, the measurement process is one-dimensional and that is how we can arrange the primary data we collect. We collect location (x, y, z), time, and many other variables such as temperature, air pressure, happiness and colour, these are the geometry of our measurements, but the collection itself is very much a one-dimensional topology.<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Michael D. Sumner.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
